---
title: "Wine About It Why Doncha"
author: "Evan"
date: "01/03/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# set root to rproj root
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
library(tidyverse)
library(readxl)
library(plotly)
```


## The Quest for the Best

Using data acquired during a night of garlic breath and shots of wine, we were tasked with finding the preferred red and white wine.

Below is a glimpse of the dataset.

```{r cars}
# read the data
wines_df  <- read_xlsx("data/garlic_games_wine_tasting.xlsx", sheet = "wine_tasting")
sample_n(wines_df, 10) %>% 
        knitr::kable()
```

## Boxplots of Ratings

The spread of ratings are shown below, using a boxplot to show the range of ratings for each wine.  Hover values show individual scoring, along with comments.

```{r echo=FALSE}


p <- wines_df %>% 
        ggplot(aes(x = fct_reorder(wine_name, colour), y = rating, text = comments, fill = colour)) + 
        geom_boxplot() + 
        geom_point() + 
        scale_y_continuous(limits = c(0, 20)) + 
        scale_fill_manual(values = c("#bf180a", "#ccc6c6")) + 
        theme_bw() + 
        theme(axis.text.x = element_text(angle = 30, hjust = 1)) + 
        coord_flip() + 
        labs(y = "Rating out of 20", x = "Wine Name", title = "Distribution of Wine Ratings by Type")

ggplotly(p)
```


## Boxplots of People

Do people tend to vote a certain way?

```{r echo=FALSE}


p <- wines_df %>% 
        ggplot(aes(x = wine_tester, y = rating, text = comments)) + 
        geom_boxplot() + 
        geom_point() + 
        scale_y_continuous(limits = c(0, 20)) + 
        scale_fill_manual(values = c("#bf180a", "#ccc6c6")) + 
        theme_bw() + 
        theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
        labs(y = "Rating out of 20", x = "Person", title = "Distribution of Wine Ratings by Person") 

ggplotly(p)
```

How about by colour by person?

```{r echo=FALSE}


p <- wines_df %>% 
        ggplot(aes(x = wine_tester, y = rating, text = comments, fill = colour)) + 
        geom_boxplot() + 
        geom_point() + 
        scale_y_continuous(limits = c(0, 20)) + 
        scale_fill_manual(values = c("#bf180a", "#ccc6c6")) + 
        theme_bw() + 
        theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
        labs(y = "Rating out of 20", x = "Person", title = "Distribution of Wine Ratings by Person") +
        facet_grid(.~colour)

ggplotly(p)
```

